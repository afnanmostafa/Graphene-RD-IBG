#Interlayer bonded Bilayer Graphene with random isolated bonds + passivation by H

dimension 3
units metal
processors * 1 1
boundary p p p
neighbor 0.3 bin
neigh_modify every 1 delay 0 check yes
#define variables

variable T equal 300.0
variable V equal lx*ly*6.7  # 3.35 (1st layer) + gap (0) + 3.35 (2nd layer)
variable dt equal 0.0001
#define lattice

atom_style atomic
read_data gr60x5ab_20.00BD.data
#define interatomic potentials

pair_style			airebo 3 1 0
pair_coeff 			* * CH.airebo C C H
dump 1 all xyz 1000 bondnew.xyz
dump_modify 1 sort id
#define thermo variable settings

timestep ${dt}

#### BOND FORMATION ####

group atom1 id 	4587 1635 11905 3023 11715 413 27 1513 7249 4029 12325 47 7725 10263 12351 5343 12297 7175 4277 8133 8953 10621 9613 9557 5039 11015 1595 11921 11187 5951 5313 10763 8553 9939 9171 3953 3271 8233 1459 309 3613 3313 9287 1501 7207 1745 4723 1945 1621 9549 927 5375 4569 10813 3715 10181 10951 3383 1421 4337 5817 4031 8581 5197 6195 6285 5009 8253 1807 11643 5607 11941 8255 3857 329 8583 5847 6083 11911 11931 2811 9125 5087 4255 12157 7421 1695 5433 7961 9083 7115 3465 1905 6913 997 8843 2387 7969 5531 5451 1275 6489 12331 2627 9109 11063 11801 2277 949 10105 11283 3911 6623 1085 3861 4141 4023 3687 5977 11561 10061 11873 8483 541 5083 3801 1403 1005 5947 9957 5199 7469 7987 11427 10237 2967 9645 9295 7403 7825 2439 8995 7697 5693 12253 7631 5391 2897 8437 11205 10449 1025 1475 9351 7101 4697 10435 11989 9017 8593 12035 2457 10671 7359 3849 4395 4679 2963 305 7909 12017 10889 10783 6781 3651 7993 115 4405 7309 9119 6673 9747 8865 10461 6139 11375 10059 9871 943 3993 8547 4187 3955 6447 1661 1719 3233 2067 11383 8919 2569 3285 771 10489 11135 9253 4063 7277 6965 7013 5621 12263 9071 8637 495 5207 6849 6695 12039 5963 12179 7055 3677 10887 2485 3425 1753 3597 12355 1341 6661 3097 8589 4365 11099 1137 11285 2881 649 4499 7459 3087 1337 10099 7819 10799 12037 2775 9175 10199 12119 8903 9139 9289 8237 11411 8693 7871 9999 3183 5273 5993 10761 12313 6357 3131 7777 4673 321 12377 215 5593 1485 7933 603 10285 1965 7815 2229 4919 557 7759 9209 4655 6803 2139 2855 11731 1309 7357 10353 4855 299 1351 7563 677 9599 9869 1775 10457 8281 12177 4291 4611 1197 3287 9925 3163 2909 607 11925 10845 185 6635 10849 6317 1521 6625 5549 2385 5025 9441 6303 9409 3033 83 9709 4681 10167 6839 8527 1921 237 6711 4375 4563 10841 4853 11257 11809 5445 3535 7949 6817 9193 1119 3043 8303 4353 10221 3411 2097 2191 1177 10015 8489 10731 3671 9923 6587 5031 11381 1911 12457 5169 8195 11479 9157 4659 411 10669 767 977 7141 6371 7647 4541 6505 3369 3565 12339 11767 6013 5527 5937 1703 5757 257 7327 6417 4923 3047 8917 1035 2615 12203 10741 2165 3965 8283 10673 4599 9319 3643 1605 4637 6709 4949 7683 11359 6857 7645 6653 5383 693 2971 9267 9749 1063 10855 2367 6609 2585 3937 3371 8785 7001 3201 7405 11215 5379 4333 11473 10927 5001 6809 5955 10891 6975 679 1991 5401 11875 2839 2717 10355 4245 3015 9055 7091 8203 6331 4441 2343 10551 10451 10037 9545 11927 4977 2399 8695 8215 1731 4115 3931 3365 8479 3713 6481 7543 3723 11345 9623 5835 407 11651 10521 3157 6301 11663 9201 9273 4263 7203 11043 11485 523 6835 9781 937 4497 10149 6911 3243 5071 2469 9223 4089 8507 3143 11465 645 911 1075 11961 11061 8259 7457 491 8901 11297 7737 7053 9931 11123 11203 12001 8991 8089 7789 363 1299 9359 11421 9821 11909 3665 5915 4743 8761 4121 11625 6883 12385 10949 10493 8751 10653 2535 6287 11821 9225 5089 3085 3487 8397 5303 6137 10183 11341 2969 6119 5525 1795 7843 3147 6521 8959 6613 7807 4457 1861 3405 2493 10485 11517 5225 8703 11155 3807 8749 9661 9953 4459 4639 7867 5961 4445 9867 985 11903 781 1697 11311 7973 4231 1121 2689 2129 5121 3493 5883 8837 11207 6113 5307 5965 12215 4845 12439 1879 12051 6851 3107 2429 10053 6097 8493 9877 11585 9035 6821 7749 6829 9263 6761 5949 3419 7467 8335 4635 7071 4731 6253 2951 8529 6543 6825 6127 1165 9167 6611 11049 3853 6023 9671 1899 10533 4081 4027 1809 7133 6539 6565 11743 2053 2835 6491 2921 1509 8373 8921 5663 10429 8459 8821 7425 4357 9521 9383 6183 9489 11899 2489 4711 1237 5669 6201 10963 2071 2393 3573 10689 9033 8983 10693 3463 6893 2401 5053 11491 7711 585 9643 9081 10173 3409 4865 9177 3075 1123 6755 593 6735 6759 8017 2651 12265 3479 9353 2333 537 43 2117 2805 6637 7387 453 2883 7117 10501 3053 11843 9631 8143 10477 10275 3237 3065 9547 851 11635 7197 5855 9825 5209 3323 5737 10417 10787 5653 99 601 11861 8897 12435 8157 10133 2259 3111 7293 10101 849 203 10877 6729 2357 11097 8719 8189 1487 10243 2851 5613 4335 6807 9835 5841 10253 10537 75 23 9113 5999 9089 801 4475 3669 2425 1205 2133 3193 2317 3749 2961 3389 3633 3459 7637 809 9809 9753 6241 7085 10819 647 9347 259 3909 5257 11475 11447 7287 1575 4085 12077 3971 10789 7119 1931 11185 11395 1649 227 1159 3495 7333 4649 5047 10755 2707 5261 8997 11515 6111 11693 4363 8145 9407 5711 9745 2337 6723 11361 2597 10751 3379 10445 10597 5269 3717 7875 3007 6409 6453 6967 5233 7113 2089 8277 7235 7407 8573 6667 9883 12273 4247 7265 3363 3733 7335 7281 12391 7937 4881 7067 10583 9799 8561 11057 5889 7739 5253 7795 11813 5733 3263 3103 543 8731 6527 4847 5311 2487 11105 6855 7531 3561 4377 3305 7757 9393 6057 611 2671 6929 3153 3063 5345 10971 2611 2563 5389 1253 2093 4303 11069 6407 11853 11805 5563 12135 7955 4603 10587 10447 1837 11513 4909 8545 6151 8129 51 2937 10003 12401 8101 8165 3455 1477 12115 1363 7383 4493 8419 7709 8911 12419 5153 10095 2167 983 10021 11607 4591 7783 1717 1631 11507 5577 1399 3117 2581 1343 12469 7643 12255 6837 4941 10213 799 10325 779 421 11169 1551 10229 3941 11871 10867 11945 3627 343 8355 11419 5077 11469 1565 12011 4371 241 11007 945 7945 1839 11151 12477 5697 4467 8543 273 295 7345 6529 1117 9427 3489 9587 1185 4327 2361 6607 2699 9101 6765 5623 11161 3719 487 7143 153 1813 11777 11367 5699 535 1525 1169 3225 3437 2829 7355 4557 9701 7779 6293 11857 1167 2677 8767 2665 4275 11577 4835 1519 5749 6569 6281 5667 5381 9311 5479 7763 11915 8915 1571 2769 8877 825 2019 3177 5181 2539 11553 4307 3859 9231 9793 1289 3317 7251 6297 35 8295 9261 4101 12031 8809 2675 6973 2801 8521 12303 3269 4517 4759 6359 717 5515 3497 947 6415 4967 7247 769 2157 8559 7707 6703 10861 6537 9509 10705 4321 6315 297 11037 6705 9707 6089 5317 5795 5617 8505 6907 3485 10175 4469 547 9985 8947 333 6115 5159 6715 11563 3119 3805 2209 1799 11803 11077 2509 1831 7995 2483 9025 5387 11799 10401 2515 6487 131 7629 867 9191 11299 3037 4965 4545 2065 

group atom2 id 	17082 14130 24316 15518 24210 12824 12522 13924 19660 16440 24736 12542 20136 22758 24846 17838 24708 19670 16688 20544 21364 23032 22024 21968 17534 23510 14090 24332 23682 18446 17724 23258 20964 22434 21666 16364 15766 20644 13954 12720 16024 15724 21782 13912 19702 14156 17218 14356 14032 21960 13422 17870 16980 23224 16210 22592 23446 15878 13832 16748 18228 16526 20992 17608 18690 18696 17420 20664 14302 24138 18102 24352 20750 16268 12740 21078 18342 18578 24406 24426 15306 21536 17582 16750 24568 19832 14190 17844 20372 21578 19610 15876 14316 19324 13408 21338 14882 20380 18026 17946 13770 18900 24826 15122 21520 23558 24212 14688 13360 22516 23778 16406 19118 13496 16272 16552 16518 16182 18388 23972 22472 24284 20978 12952 17578 16212 13898 13416 18442 22368 17694 19880 20482 23922 22648 15462 22056 21790 19898 20236 14934 21490 20108 18104 24664 20126 17886 15308 20848 23616 22860 13436 13970 21846 19512 17108 22930 24400 21428 21004 24530 14868 23166 19854 16260 16890 17174 15458 12716 20320 24428 23300 23278 19192 16146 20404 12610 16816 19720 21614 19084 22242 21276 22872 18634 23870 22554 22366 13438 16404 21042 16682 16450 18942 14072 14214 15644 14562 23878 21414 14980 15696 13266 22900 23630 21664 16558 19688 19376 19424 18032 24758 21566 21048 12990 17702 19260 19190 24534 18458 24674 19550 16088 23382 14896 15836 14164 16008 24850 13752 19072 15508 21000 16776 23594 13548 23696 15292 13060 16994 19954 15582 13748 22594 20314 23294 24448 15270 21670 22694 24614 21398 21634 21700 20648 23906 21104 20366 22494 15678 17684 18404 23172 24724 18768 15626 20188 17084 12732 24788 12710 18004 13896 20344 13098 22696 14376 20310 14640 17414 12968 20254 21620 17150 19298 14634 15350 24226 13720 19768 22764 17350 12794 13846 20058 13088 22094 22280 14270 22868 20692 24588 16786 17106 13608 15782 22336 15658 15320 13102 24336 23256 12596 19130 23260 18728 13932 19036 17960 14796 17436 21852 18798 21820 15444 12578 22120 17092 22662 19334 21022 14332 12648 19206 16870 17058 23252 17264 23668 24220 17856 16030 20360 19228 21604 13614 15538 20798 16764 22632 15906 14508 14686 13588 22510 20900 23226 16166 22418 19082 17526 23792 14406 24868 17580 20690 23974 21568 17154 12906 23080 13262 13388 19552 18866 20142 16952 18916 15780 15976 24834 24262 18424 18022 18348 14198 18168 12668 19822 18828 17418 15542 21328 13530 15110 24698 23152 14576 16376 20778 23084 17094 21814 16138 14016 17048 19120 17360 20178 23854 19268 20056 19064 17878 13104 15466 21762 22160 13558 23350 14862 19020 14996 16348 15866 21196 19412 15612 19816 23710 17874 16744 23884 23422 17412 19220 18450 23386 19470 13174 14486 17812 24370 15334 15128 22850 16656 15510 21550 19586 20698 18826 16852 14838 23046 22946 22448 21956 24422 17388 14894 21190 20710 14226 16610 16426 15776 20974 16124 18892 20038 16218 23756 22118 18330 12902 24146 22932 15568 18712 24158 21612 21684 16758 19698 23538 23896 13018 19330 22192 13348 16908 22560 19406 15738 17566 14880 21718 16500 21002 15638 23876 13056 13406 13570 24372 23472 20754 19868 12986 21312 23708 20148 19464 22426 23618 23698 24412 21486 20500 20200 12858 13794 21854 23832 22232 24320 16076 18410 17238 21172 16532 24036 19378 24796 23360 22904 21246 23064 15030 18782 24232 21636 17500 15496 15982 20808 17798 18548 22678 23752 15380 18614 17936 14290 20338 15642 18932 21454 19024 20302 16868 14272 15816 14904 22896 23928 17636 21198 23650 16302 21160 22072 22364 16954 17134 20362 18372 16856 22362 13396 24398 13192 14108 23806 20384 16726 13532 15100 14540 17532 15904 18378 21248 23702 18524 17802 18376 24710 17256 24934 14374 24546 19346 15602 14840 22464 18508 20904 22288 23996 21530 19232 20160 19240 21758 19172 18360 15914 19962 20830 17130 19566 17226 18664 15446 20940 19038 19236 18622 13576 21662 19106 23460 16264 18518 22166 14394 22944 16492 16522 14220 19544 19034 18976 24238 14464 15330 18986 15332 13920 20784 21332 18158 22840 20954 21232 19836 16768 21932 21878 18678 21900 24394 14900 17206 13648 18080 18612 23458 14566 14804 15984 23100 21444 21478 23104 15958 19304 14812 17464 23986 20206 12996 22138 21492 22584 15820 17276 21588 15570 13618 19250 13004 19230 19254 20428 15146 24676 15974 21764 14744 12948 12538 14528 15216 19048 19882 12864 15378 19528 22912 15464 24338 22126 20638 22888 22770 15648 15476 22042 13346 24130 19608 18350 22236 17620 15818 18148 22828 23282 18064 12594 13012 24272 21308 24930 20568 22544 14754 15606 19704 22512 13260 12698 23288 19140 14768 23508 21214 20600 13982 22738 15346 18024 16830 19302 22330 18252 22664 22948 12570 12518 21524 18494 21500 13212 16970 16080 14836 13616 14544 15604 14728 16160 15372 15800 16044 15954 20048 13220 22220 22164 18652 19496 23314 13142 21842 12754 16320 17668 23970 23942 19782 14070 16496 24488 16466 23200 19614 14426 23596 23890 14060 12722 13654 15990 19744 17060 17542 23250 15202 17672 21408 24010 18606 24104 16858 20556 21902 18206 22156 14748 19218 23772 15008 23246 15874 22856 23008 17680 16128 20370 15502 18820 18864 19462 17644 19524 14500 20688 19730 19902 20984 19162 22378 24684 16742 19676 15858 16144 19830 19692 24886 20348 17292 19562 23078 22294 20972 23468 18300 20234 17664 20290 24224 18144 15758 15598 13038 21226 19022 17342 17806 14982 23516 19350 20026 15972 16788 15716 20168 21804 18468 13106 15166 19340 15564 15558 17756 23466 15106 15058 17800 13664 14504 16798 23480 18902 24264 24216 18058 24630 20450 17098 23082 22942 14248 23924 17320 20956 18646 20540 12546 15348 22498 24812 20512 20576 15950 13888 24610 13858 19878 16904 20914 20120 21406 24914 17564 22590 14662 13478 22432 24102 17086 20278 14128 14126 24002 17988 13894 15528 14992 13838 24880 20138 24750 19248 17352 22624 13294 22736 13274 12832 23580 14046 22640 16352 24366 23362 24356 16122 12838 20850 23914 17488 23880 13976 24506 16866 12652 23502 13356 20356 14334 23646 24888 18108 16962 21038 12684 12790 19756 18940 13528 21922 15900 22082 13596 16822 14772 19102 15194 21512 19176 18118 23572 16214 12982 19638 12564 14224 24188 23862 18194 13030 13936 13580 15636 15848 15240 19850 16968 22112 20274 18704 24268 13662 15088 21262 15076 16770 23988 17330 14014 18160 18980 18692 18162 17792 21806 17974 20258 24410 21410 14066 15180 21288 13236 14514 15588 17592 15034 23964 16802 16354 21726 22204 13700 15728 19746 18708 12530 20790 21672 16512 24526 21220 15170 19384 15212 20932 24798 15680 16928 17254 18854 13128 18010 15908 13442 18910 17462 19742 13180 14568 21054 20202 19198 23272 18948 21920 23116 16732 18810 12708 23448 19116 22202 18500 17728 18290 18028 20916 19402 15896 22670 16880 13042 22396 21442 12744 18610 17654 19210 24058 15614 16216 14620 14294 24298 23488 14920 14326 20490 14978 21436 17882 24294 22812 15010 18982 12626 20040 13362 21686 23794 15448 17376 16956 14476 

displace_atoms atom1 move 0 0 1.15 units box
displace_atoms atom2 move 0 0 -1.15 units box

# ======= grouping bonded and non-bonded atoms ======= #

group bonded union atom1 atom2
group nonbonded subtract all bonded

# ======= thermodynamics output setting ======= #

thermo_style    	custom step time temp press pxx pyy pzz pe ke etotal
thermo          	1000

# ======= minimization ======= #

min_style		cg
fix 			1 all box/relax x 0.0 y 0.0 z 0.0 couple xyz
minimize		0 1e-10 200000 400000
unfix			1

# ======= equilibration ======= #

fix 2 all recenter INIT INIT INIT

fix 1 nonbonded npt temp $T $T 0.1 x 0.0 0.0 1.0 y 0.0 0.0 1.0 couple xy
run 50000
unfix 1

fix 1 all npt temp $T $T 0.1 x 0.0 0.0 1.0 y 0.0 0.0 1.0 couple xy
run 50000
unfix 1
unfix 2

fix NVE all nve
fix				ts all temp/rescale 1 $T $T $(100.0*dt) 1.0
run 50000
unfix     ts
unfix     NVE

# ======= write output ======= #

write_data post_equil.data

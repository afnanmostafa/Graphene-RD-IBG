#RD-IBG from 2D diamond (top-down)

dimension 3
units metal
processors * * 1
boundary p p p
neighbor 0.3 bin
neigh_modify every 1 delay 0 check yes

#define variables
variable T equal 300.0
variable V equal lx*ly*6.7  # 3.35 (1st layer) + gap (0) + 3.35 (2nd layer)
variable dt equal 0.0001

#lattice
atom_style atomic
read_data RDIBG_ab_2layers_10x10_5.00_BD.data

#define interatomic potentials
pair_style			airebo 3 1 0
pair_coeff 			* * CH.airebo C C H

dump equil all xyz 1000 equilibration.xyz
dump_modify equil sort id

#define thermo variable settings
timestep ${dt}

#### BOND FORMATION ####

group atom1 id 	107 135 159 201 223 235 239 259 279 291 311 319 349 361 371 385 387 433 459 463 471 477 549 563 569 571 593 597 613 635 685 717 725 751 781 791 811 829 863 881 891 895 907 923 937 947 971 999 1023 1035 1041 1061 1089 1157 1221 1259 1265 1271 1279 1293 1331 1355 1359 1399 1411 1417 1427 1433 1437 1459 1487 1519 1545 1551 1613 1639 1663 1675 1689 1695 1723 1735 1749 1827 1851 1925 1929 1963 1977 1979 1993 1995 1997 1999 2031 2047 2053 2059 2077 2097 2111 2115 2139 2149 2163 2171 2175 2255 2281 2287 2291 2293 2307 2325 2339 2359 2369 2383 2389 2393 2407 2409 2411 2433 2461 2487 2499 2507 2537 2567 2591 2609 2611 2657 2661 2667 2669 2703 2763 2765 2771 2807 2831 2861 2865 2871 2885 2911 2943 2951 2975 3003 3047 3131 3145 3195 3199 3217 3231 3293 3313 3341 3381 3411 3419 3421 3429 3477 3499 3501 3521 3589 3593 3597 3619 3651 3665 3669 3709 3715 3723 3739 3783 3839 3861 3871 3885 3943 3961 3977 3991 4005 4011 4013 

group atom2 id 	4138 4166 4190 4068 4254 4266 4270 4290 4310 4322 4342 4350 4216 4228 4402 4252 4418 4300 4490 4494 4502 4344 4416 4594 4436 4602 4460 4464 4480 4666 4552 4584 4592 4782 4648 4822 4842 4696 4894 4748 4922 4926 4938 4954 4804 4978 5002 5030 5054 5066 4908 4928 4956 5024 5088 5290 5132 5302 5310 5160 5362 5386 5390 5430 5442 5284 5458 5300 5304 5490 5518 5550 5412 5582 5480 5670 5694 5706 5556 5726 5754 5766 5616 5858 5882 5792 5796 5994 5844 6010 5860 6026 5864 6030 6062 6078 5920 6090 5944 5964 6142 6146 6170 6016 6194 6202 6206 6286 6148 6318 6322 6160 6338 6192 6370 6390 6236 6414 6256 6260 6438 6276 6442 6300 6328 6518 6530 6538 6404 6598 6622 6476 6642 6524 6528 6698 6536 6734 6794 6632 6802 6838 6862 6728 6732 6902 6752 6942 6974 6982 7006 7034 7078 7162 7012 7226 7230 7084 7262 7160 7180 7208 7248 7442 7450 7288 7296 7344 7530 7368 7388 7456 7460 7464 7650 7682 7532 7536 7576 7746 7754 7770 7814 7870 7728 7902 7752 7974 7828 7844 8022 7872 8042 7880 

displace_atoms atom1 move 0 0 1.15 units box
displace_atoms atom2 move 0 0 -1.15 units box

run 2000

group bonded union atom1 atom2
group nonbonded subtract all bonded

thermo_style  custom step time temp press pxx pyy pzz pe ke etotal
thermo    1000

# ======= minimization =======

min_style cg
minimize  1e-10 1e-10 200000 400000

write_data post_mini.data

# ======= equilibration =======

fix 2 all recenter INIT INIT INIT

fix 1 nonbonded npt temp $T $T 0.1 x 0.0 0.0 1.0 y 0.0 0.0 1.0 couple xy
run 150000
unfix 1

fix 1 all npt temp $T $T 0.1 x 0.0 0.0 1.0 y 0.0 0.0 1.0 couple xy
run 200000
unfix 1
unfix 2

write_data post_equil.data

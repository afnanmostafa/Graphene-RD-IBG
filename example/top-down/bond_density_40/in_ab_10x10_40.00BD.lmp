#RD-IBG from 2D diamond (top-down)

dimension 3
units metal
processors * * 1
boundary p p p
neighbor 0.3 bin
neigh_modify every 1 delay 0 check yes

#define variables
variable T equal 300.0
variable V equal lx*ly*6.7  # 3.35 (1st layer) + gap (0) + 3.35 (2nd layer)
variable dt equal 0.0001

#lattice
atom_style atomic
read_data RDIBG_ab_2layers_10x10_40.00_BD.data

#define interatomic potentials
pair_style			airebo 3 1 0
pair_coeff 			* * CH.airebo C C H

dump equil all xyz 1000 equilibration.xyz
dump_modify equil sort id

#define thermo variable settings
timestep ${dt}

#### BOND FORMATION ####

group atom1 id 	3 7 15 19 23 27 31 35 39 43 47 55 59 63 67 71 75 79 83 87 99 103 107 111 115 119 127 131 135 143 147 151 155 163 171 173 175 179 181 183 185 187 189 191 195 197 199 203 205 209 211 213 215 217 219 221 223 225 227 229 231 233 235 237 239 241 243 245 247 249 251 253 255 257 261 263 267 269 271 273 275 277 281 283 285 287 289 291 293 295 301 305 307 309 311 319 321 323 325 327 329 331 333 339 341 343 347 349 351 353 355 357 359 361 363 365 367 369 373 375 377 379 381 383 385 387 389 393 395 397 399 401 403 405 411 413 415 421 423 425 429 431 433 435 437 441 443 445 447 449 453 455 457 459 461 465 469 471 473 475 479 481 483 485 487 489 491 493 495 497 499 501 507 513 515 517 521 525 527 535 541 543 549 551 553 555 557 559 561 563 565 569 577 579 581 583 585 587 591 593 595 597 603 605 607 609 611 613 615 617 619 621 625 627 629 631 633 635 639 641 643 649 653 655 657 659 661 663 665 667 669 675 677 679 681 683 685 687 689 693 695 697 699 701 703 705 707 709 711 713 715 717 719 721 723 727 731 739 741 743 747 749 751 753 755 759 761 763 765 767 769 775 779 781 785 789 791 793 795 797 799 801 803 805 807 811 813 815 817 819 821 823 831 833 835 837 843 845 847 849 851 853 855 857 859 863 865 867 869 873 875 877 879 883 885 887 889 891 893 895 897 899 901 903 905 907 909 911 913 915 925 927 929 931 935 937 939 941 943 945 947 949 951 953 955 959 961 963 965 967 969 971 973 975 977 979 981 983 985 987 989 991 993 995 999 1003 1005 1011 1013 1015 1019 1021 1023 1025 1027 1029 1031 1035 1037 1041 1045 1049 1051 1053 1055 1057 1059 1061 1063 1065 1067 1069 1073 1075 1077 1079 1081 1083 1085 1087 1089 1091 1093 1095 1097 1101 1103 1109 1111 1113 1115 1119 1121 1123 1125 1129 1131 1133 1135 1137 1141 1145 1147 1149 1151 1155 1157 1159 1161 1167 1171 1173 1179 1181 1187 1189 1191 1193 1195 1197 1199 1201 1203 1205 1207 1209 1215 1217 1219 1221 1223 1225 1227 1229 1231 1235 1241 1243 1245 1247 1249 1251 1253 1255 1257 1259 1261 1263 1265 1267 1269 1271 1273 1275 1277 1279 1281 1283 1287 1289 1291 1293 1295 1297 1299 1301 1303 1305 1307 1313 1315 1317 1319 1321 1323 1325 1327 1329 1333 1339 1341 1347 1349 1351 1353 1355 1357 1359 1367 1369 1371 1373 1375 1379 1381 1383 1385 1387 1389 1391 1393 1395 1397 1399 1401 1407 1411 1413 1415 1417 1419 1421 1423 1427 1429 1433 1435 1439 1441 1443 1445 1449 1451 1453 1455 1457 1459 1461 1463 1467 1469 1471 1473 1475 1477 1479 1481 1485 1487 1489 1491 1495 1499 1501 1503 1505 1507 1509 1515 1517 1521 1523 1525 1527 1529 1531 1535 1537 1541 1543 1545 1547 1551 1553 1555 1557 1561 1563 1565 1567 1571 1573 1575 1577 1579 1583 1585 1587 1589 1591 1595 1597 1599 1601 1605 1609 1611 1613 1615 1617 1619 1621 1623 1627 1629 1631 1633 1637 1639 1643 1645 1647 1649 1651 1653 1655 1657 1659 1661 1665 1667 1669 1671 1673 1677 1685 1687 1689 1691 1693 1695 1697 1699 1701 1703 1705 1707 1709 1713 1715 1717 1719 1721 1723 1725 1727 1729 1731 1733 1735 1737 1739 1741 1743 1745 1747 1749 1751 1753 1757 1763 1765 1767 1769 1771 1773 1775 1777 1781 1783 1785 1787 1789 1791 1795 1797 1799 1801 1803 1805 1807 1809 1811 1815 1817 1825 1827 1829 1831 1833 1835 1837 1839 1841 1843 1845 1851 1853 1855 1857 1861 1863 1865 1867 1871 1873 1875 1879 1881 1883 1885 1887 1889 1891 1895 1897 1899 1901 1903 1905 1907 1909 1913 1915 1917 1919 1921 1923 1925 1927 1929 1931 1933 1935 1937 1939 1941 1943 1949 1951 1953 1955 1957 1961 1965 1967 1969 1971 1975 1977 1979 1981 1987 1991 1993 1995 1997 2003 2005 2007 2009 2011 2013 2019 2021 2023 2025 2027 2029 2031 2035 2037 2041 2043 2045 2047 2049 2051 2053 2055 2057 2059 2061 2063 2065 2069 2071 2073 2075 2077 2079 2081 2083 2087 2089 2091 2093 2095 2097 2099 2101 2103 2107 2109 2111 2113 2115 2117 2119 2121 2125 2127 2129 2131 2135 2137 2139 2141 2143 2145 2147 2149 2151 2153 2155 2157 2161 2165 2167 2171 2173 2175 2177 2179 2181 2189 2191 2193 2195 2199 2201 2203 2205 2207 2209 2211 2213 2217 2219 2223 2225 2227 2229 2233 2237 2239 2243 2245 2247 2249 2251 2253 2255 2257 2259 2261 2263 2265 2269 2273 2275 2283 2285 2287 2293 2295 2297 2301 2303 2305 2307 2309 2313 2315 2321 2323 2325 2327 2329 2331 2339 2341 2343 2345 2347 2355 2357 2359 2361 2363 2365 2373 2375 2377 2379 2381 2383 2385 2387 2391 2393 2395 2397 2399 2401 2407 2409 2411 2415 2417 2419 2421 2423 2425 2427 2429 2431 2433 2435 2439 2441 2443 2445 2447 2449 2451 2453 2455 2457 2461 2463 2467 2469 2471 2473 2475 2479 2481 2489 2491 2493 2495 2497 2499 2503 2505 2507 2509 2511 2513 2523 2525 2527 2529 2531 2533 2535 2539 2541 2543 2545 2547 2551 2553 2555 2559 2561 2563 2565 2567 2573 2575 2577 2579 2581 2583 2587 2589 2591 2593 2595 2597 2605 2607 2609 2611 2613 2617 2619 2621 2623 2625 2627 2629 2631 2633 2635 2639 2641 2643 2645 2647 2649 2651 2655 2657 2659 2661 2663 2665 2667 2669 2671 2673 2675 2677 2679 2683 2691 2695 2697 2699 2701 2703 2705 2707 2713 2715 2717 2719 2721 2723 2725 2727 2729 2731 2733 2735 2737 2739 2741 2743 2745 2747 2749 2751 2753 2755 2757 2761 2765 2769 2771 2775 2777 2779 2781 2783 2785 2787 2789 2791 2793 2795 2799 2801 2805 2809 2811 2813 2815 2817 2819 2825 2829 2831 2833 2837 2839 2841 2845 2847 2849 2851 2853 2859 2861 2865 2867 2869 2871 2873 2875 2877 2879 2883 2885 2887 2893 2895 2897 2899 2901 2903 2905 2907 2909 2911 2915 2917 2919 2921 2923 2925 2927 2929 2933 2937 2941 2943 2945 2947 2949 2951 2953 2955 2959 2961 2963 2965 2967 2969 2971 2973 2975 2977 2979 2983 2987 2989 2991 2993 2995 2999 3001 3005 3007 3009 3011 3013 3015 3019 3021 3027 3029 3031 3033 3035 3037 3039 3047 3053 3061 3063 3065 3067 3071 3073 3077 3079 3081 3083 3085 3087 3089 3091 3095 3097 3099 3101 3105 3107 3111 3113 3115 3117 3121 3123 3125 3129 3131 3133 3135 3139 3141 3145 3149 3151 3153 3159 3161 3163 3165 3167 3169 3171 3177 3179 3183 3185 3187 3189 3195 3197 3203 3205 3209 3211 3215 3217 3219 3221 3223 3225 3227 3229 3233 3235 3237 3239 3241 3243 3247 3249 3253 3255 3257 3259 3261 3263 3265 3267 3271 3273 3275 3279 3281 3283 3285 3289 3291 3295 3299 3301 3305 3307 3309 3311 3313 3315 3321 3323 3325 3329 3331 3333 3335 3337 3345 3347 3351 3353 3357 3363 3365 3367 3369 3381 3383 3387 3389 3391 3393 3395 3397 3399 3401 3405 3409 3411 3413 3417 3421 3425 3427 3431 3433 3435 3437 3439 3441 3443 3445 3447 3449 3451 3453 3455 3457 3461 3463 3465 3467 3471 3477 3479 3481 3485 3487 3489 3491 3497 3501 3503 3505 3507 3513 3515 3517 3521 3523 3525 3535 3537 3539 3543 3547 3549 3551 3553 3555 3557 3559 3561 3563 3567 3571 3575 3579 3581 3585 3587 3589 3591 3593 3597 3599 3601 3603 3611 3613 3615 3617 3621 3625 3627 3629 3631 3635 3637 3639 3643 3645 3647 3649 3651 3653 3655 3659 3661 3663 3665 3667 3671 3675 3679 3681 3683 3685 3687 3689 3691 3699 3701 3703 3705 3709 3711 3713 3715 3717 3719 3723 3725 3727 3731 3735 3737 3739 3741 3743 3745 3749 3751 3753 3755 3757 3759 3761 3763 3765 3767 3769 3771 3773 3777 3781 3783 3785 3787 3789 3793 3795 3799 3803 3807 3809 3811 3815 3817 3819 3821 3823 3825 3829 3831 3833 3835 3837 3839 3841 3843 3845 3849 3851 3855 3857 3859 3861 3869 3871 3873 3875 3877 3879 3881 3885 3887 3893 3895 3897 3901 3905 3907 3909 3913 3915 3917 3919 3923 3925 3927 3929 3933 3935 3937 3939 3941 3943 3945 3951 3959 3965 3967 3969 3973 3975 3977 3979 3985 3987 3989 3991 3993 3995 3997 3999 4001 4003 4005 4007 4009 4013 4015 4017 4019 4021 4023 4025 4027 4029 

group atom2 id 	4034 4038 4046 4050 4054 4058 4062 4066 4070 4074 4078 4086 4090 4094 4098 4102 4106 4110 4114 4118 4130 4134 4138 4142 4146 4150 4158 4162 4166 4174 4178 4182 4186 4194 4202 4040 4206 4210 4048 4214 4052 4218 4056 4222 4226 4064 4230 4234 4072 4076 4242 4080 4246 4084 4250 4088 4254 4092 4258 4096 4262 4100 4266 4104 4270 4108 4274 4112 4278 4116 4282 4120 4286 4124 4128 4294 4298 4136 4302 4140 4306 4144 4148 4314 4152 4318 4156 4322 4160 4326 4168 4172 4338 4176 4342 4350 4188 4354 4192 4358 4196 4362 4200 4370 4208 4374 4378 4216 4382 4220 4386 4224 4390 4228 4394 4232 4398 4236 4240 4406 4244 4410 4248 4414 4252 4418 4256 4260 4426 4264 4430 4268 4434 4272 4442 4280 4446 4288 4454 4292 4296 4462 4300 4466 4304 4308 4474 4312 4478 4316 4320 4486 4324 4490 4328 4332 4336 4502 4340 4506 4510 4348 4514 4352 4518 4356 4522 4360 4526 4364 4530 4368 4538 4380 4546 4384 4388 4392 4558 4566 4408 4574 4416 4582 4420 4586 4424 4590 4428 4594 4432 4436 4444 4610 4448 4614 4452 4618 4622 4460 4626 4464 4634 4472 4638 4476 4642 4480 4646 4484 4650 4488 4492 4658 4496 4662 4500 4666 4670 4508 4674 4516 4520 4686 4524 4690 4528 4694 4532 4698 4536 4706 4544 4710 4548 4714 4552 4718 4556 4560 4726 4564 4730 4568 4734 4572 4738 4576 4742 4580 4746 4584 4750 4588 4754 4758 4762 4770 4608 4774 4778 4616 4782 4620 4786 4790 4628 4794 4632 4798 4636 4806 4810 4648 4652 4656 4822 4660 4826 4664 4830 4668 4834 4672 4838 4842 4680 4846 4684 4850 4688 4854 4862 4700 4866 4704 4874 4712 4878 4716 4882 4720 4886 4724 4890 4894 4732 4898 4736 4740 4906 4744 4910 4914 4752 4918 4756 4922 4760 4926 4764 4930 4768 4934 4772 4938 4776 4942 4780 4946 4792 4958 4796 4962 4966 4804 4970 4808 4974 4812 4978 4816 4982 4820 4986 4990 4828 4994 4832 4998 4836 5002 4840 5006 4844 5010 4848 5014 4852 5018 4856 5022 4860 5026 5030 5034 4872 5042 4880 5046 5050 4888 5054 4892 5058 4896 5062 5066 4904 4908 4912 4916 5082 4920 5086 4924 5090 4928 5094 4932 5098 4936 4940 5106 4944 5110 4948 5114 4952 5118 4956 5122 4960 5126 4964 4968 5134 4976 5142 4980 5146 5150 4988 5154 4992 4996 5162 5000 5166 5004 5008 5012 5178 5016 5182 5186 5024 5190 5028 5198 5202 5040 5210 5048 5218 5056 5222 5060 5226 5064 5230 5068 5234 5072 5238 5076 5246 5084 5250 5088 5254 5092 5258 5096 5262 5266 5108 5274 5112 5278 5116 5282 5120 5286 5124 5290 5128 5294 5132 5298 5136 5302 5140 5306 5144 5310 5148 5314 5318 5156 5322 5160 5326 5164 5330 5168 5334 5172 5338 5180 5346 5184 5350 5188 5354 5192 5358 5196 5200 5370 5208 5378 5216 5382 5220 5386 5224 5390 5398 5236 5402 5240 5406 5410 5248 5414 5252 5418 5256 5422 5260 5426 5264 5430 5268 5438 5442 5280 5446 5284 5450 5288 5454 5458 5296 5300 5466 5470 5308 5474 5312 5316 5482 5320 5486 5324 5490 5328 5494 5498 5336 5502 5340 5506 5344 5510 5348 5352 5518 5356 5522 5526 5530 5368 5534 5372 5538 5376 5546 5384 5388 5554 5392 5558 5396 5562 5566 5404 5408 5574 5412 5578 5582 5420 5586 5424 5428 5594 5432 5598 5602 5440 5606 5444 5610 5614 5452 5618 5456 5622 5626 5464 5630 5468 5472 5476 5642 5480 5646 5484 5650 5488 5654 5658 5496 5662 5500 5504 5670 5674 5512 5678 5516 5682 5520 5686 5524 5690 5528 5532 5698 5536 5702 5540 5544 5552 5718 5556 5722 5560 5726 5564 5730 5568 5734 5572 5738 5576 5580 5746 5584 5750 5588 5754 5592 5758 5596 5762 5600 5766 5604 5770 5608 5774 5612 5778 5616 5782 5620 5624 5794 5632 5798 5636 5802 5640 5806 5644 5648 5814 5652 5818 5656 5822 5826 5664 5830 5668 5834 5672 5838 5676 5842 5846 5684 5692 5858 5696 5862 5700 5866 5704 5870 5708 5874 5712 5882 5720 5886 5724 5728 5894 5732 5898 5902 5740 5906 5910 5748 5914 5752 5918 5756 5922 5926 5764 5930 5768 5934 5772 5938 5776 5780 5946 5784 5950 5788 5954 5792 5958 5796 5962 5800 5966 5804 5970 5808 5974 5816 5982 5820 5986 5824 5828 5832 5998 5836 6002 6006 5844 6010 5848 6018 6022 5860 6026 5864 6034 5872 6038 5876 6042 5880 6050 5888 6054 5892 6058 5896 6062 6066 5904 5908 6074 5912 6078 5916 6082 5920 6086 5924 6090 5928 6094 5932 5936 6102 5940 6106 5944 6110 5948 6114 6118 5956 6122 5960 6126 5964 6130 5968 6134 6138 5976 6142 5980 6146 5984 6150 5988 5992 6158 5996 6162 6166 6004 6170 6008 6174 6012 6178 6016 6182 6020 6186 6024 6028 6032 6198 6202 6040 6206 6044 6210 6048 6056 6222 6060 6226 6230 6068 6234 6072 6238 6076 6242 6080 6084 6250 6254 6092 6258 6096 6100 6104 6270 6274 6112 6278 6116 6282 6120 6286 6124 6290 6128 6294 6132 6136 6140 6306 6314 6152 6318 6160 6326 6164 6168 6334 6172 6338 6176 6180 6346 6188 6354 6192 6358 6196 6362 6370 6208 6374 6212 6378 6386 6224 6390 6228 6394 6232 6240 6406 6244 6410 6248 6414 6252 6418 6422 6260 6426 6264 6430 6268 6438 6276 6442 6446 6284 6450 6288 6454 6292 6458 6296 6462 6300 6466 6470 6308 6474 6312 6478 6316 6482 6320 6486 6324 6328 6494 6498 6336 6502 6340 6506 6510 6348 6356 6522 6360 6526 6364 6530 6534 6372 6538 6376 6542 6380 6554 6392 6558 6396 6562 6400 6566 6570 6408 6574 6412 6578 6582 6420 6586 6590 6428 6594 6432 6598 6440 6606 6444 6610 6448 6614 6618 6456 6622 6460 6626 6464 6472 6638 6476 6642 6480 6484 6650 6488 6654 6492 6658 6496 6662 6500 6666 6670 6508 6674 6512 6678 6516 6682 6686 6524 6690 6528 6694 6532 6698 6536 6702 6540 6706 6544 6710 6714 6722 6726 6564 6730 6568 6734 6572 6738 6580 6746 6584 6750 6588 6754 6592 6758 6596 6762 6600 6766 6604 6770 6608 6774 6612 6778 6616 6782 6620 6786 6624 6628 6632 6636 6802 6806 6644 6810 6648 6814 6652 6818 6656 6822 6660 6826 6830 6668 6672 6676 6842 6680 6846 6684 6850 6692 6696 6862 6700 6704 6870 6708 6712 6878 6716 6882 6720 6890 6728 6732 6898 6736 6902 6740 6906 6744 6910 6914 6752 6918 6760 6926 6764 6930 6768 6934 6772 6938 6776 6942 6946 6784 6950 6788 6954 6792 6958 6796 6800 6804 6808 6974 6812 6978 6816 6982 6820 6986 6990 6828 6994 6832 6998 6836 7002 6840 7006 6844 7010 7014 7018 6856 7022 6860 7026 7030 6868 6872 7038 6876 7042 6880 7046 7050 6888 7058 6896 7062 6900 7066 6904 7070 7078 6920 6928 7094 6932 7098 7102 6940 6944 7110 6948 7114 6952 7118 6956 7122 7126 6964 7130 6968 6972 7138 7142 6980 7146 6984 6988 7154 6992 6996 7162 7000 7166 7170 7008 7012 7016 7182 7020 7190 7028 7194 7032 7198 7036 7202 7044 7210 7214 7052 7218 7056 7226 7064 7234 7072 7076 7242 7246 7084 7250 7088 7254 7092 7258 7096 7100 7266 7104 7270 7108 7274 7278 7116 7120 7286 7124 7290 7128 7294 7132 7298 7302 7140 7306 7310 7148 7314 7152 7156 7322 7326 7330 7168 7172 7338 7176 7342 7180 7346 7188 7354 7192 7196 7362 7200 7366 7204 7212 7378 7382 7220 7224 7394 7232 7398 7236 7248 7414 7418 7256 7422 7260 7426 7264 7430 7268 7272 7276 7442 7280 7284 7288 7292 7458 7462 7300 7466 7304 7470 7308 7474 7312 7478 7316 7482 7320 7486 7324 7328 7494 7332 7498 7502 7344 7510 7348 7352 7518 7356 7522 7364 7368 7534 7372 7538 7380 7546 7384 7388 7554 7392 7566 7404 7570 7574 7578 7416 7582 7420 7586 7424 7590 7428 7594 7598 7602 7606 7610 7448 7452 7618 7456 7622 7460 7464 7630 7468 7634 7642 7480 7646 7484 7488 7492 7658 7496 7662 7666 7504 7670 7674 7512 7678 7516 7682 7520 7686 7690 7528 7694 7532 7698 7702 7706 7710 7548 7714 7552 7718 7556 7722 7730 7568 7734 7572 7576 7742 7580 7746 7584 7750 7754 7592 7758 7762 7766 7604 7770 7608 7774 7612 7616 7782 7620 7786 7624 7790 7628 7794 7632 7798 7636 7802 7640 7644 7648 7814 7652 7818 7656 7660 7826 7830 7834 7838 7676 7842 7846 7684 7850 7688 7854 7692 7696 7862 7700 7866 7704 7870 7708 7874 7712 7716 7882 7886 7724 7890 7728 7736 7902 7740 7906 7744 7910 7748 7752 7918 7760 7926 7764 7768 7772 7938 7776 7780 7946 7784 7950 7954 7792 7958 7796 7800 7966 7804 7970 7808 7974 7812 7982 7990 7832 7998 7836 7840 8006 7844 8010 7852 8018 7856 8022 7860 8026 7864 8030 7868 8034 7872 8038 7876 7880 8046 7884 8050 7888 8054 7892 8058 7896 

displace_atoms atom1 move 0 0 1.15 units box
displace_atoms atom2 move 0 0 -1.15 units box

run 2000

group bonded union atom1 atom2
group nonbonded subtract all bonded

thermo_style  custom step time temp press pxx pyy pzz pe ke etotal
thermo    1000

# ======= minimization =======

min_style cg
minimize  1e-10 1e-10 200000 400000

write_data post_mini.data

# ======= equilibration =======

fix 2 all recenter INIT INIT INIT

fix 1 nonbonded npt temp $T $T 0.1 x 0.0 0.0 1.0 y 0.0 0.0 1.0 couple xy
run 150000
unfix 1

fix 1 all npt temp $T $T 0.1 x 0.0 0.0 1.0 y 0.0 0.0 1.0 couple xy
run 200000
unfix 1
unfix 2

write_data post_equil.data
